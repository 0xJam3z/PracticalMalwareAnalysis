Practical Malware Analysis by Sikorski & Hoing
Lab 1-3
1. Upload the Lab01-03.exe file to https://www.VirusTotal.com and view the reports. Does it match any existing antivirus definitions?

VirusTotal indicates the detection ratio is 64/76.
2. Are there any indications that this file is packed or obfuscated? If so, what are these indicators? If the file is packed, unpack it if possible.

PEid shows the file is packed with 'FSG 1.0 -> dulek/xt.' Unpacking this with ollydbg->ollydump thanks to https://www.aldeid.com/wiki/Category:Digital-Forensics/Computer-Forensics/Anti-Reverse-Engineering/Packers/FSG reveals the file was compiled with Microsoft Visual C++ 6.0.
3. Do any imports hint at this program's functionality? If so, which imports are they and what do they tell you?

Strings reveals quite a bit but the only notable piece for this writeup I'll use from strings is a string called 'http://www.malwareanalysisbook.com/ad.html Let's pull this into dependency walker and do a step by step static analysis.
MSVCRT.DLL most notably the function calls __set_app_type, _p_initenv, _controlfp we can infer that we're setting and initializing a program.
OLE32.dll uses three functions 'CoCreateInstance, OleInitialize, OleUnitialize. This tells us we're creating a COM object and pulling from OLE libraries.
Advapi32.dll has enough functions to show that the malware is working with the registry. Opening, querying, and modifying keys.
WINTRUST.dll is called only for the function WinVerifyTrust tells us the virus signature is attemping to verify itself.
SECUR32.dll is called getting a GetUserNameExA, LSaLogonUser, and LsaConnectUntrusted.
GDI32.dll has a lot of function calls informing us GUI is being used.
Kernel32.dll is called using a wide array of functions letting us know this malware is tampering with windows libraries.
RPCRT4.dll is called letting us know this malware is making a remote call to an outside agent.
Finally, USER32.dll is called using a wide array of functions indicating the use of keylogging, kill timers, loading/viewing messages, all indicating the use of keylogging functionality. Moreover, functions also are present indicating clipboard data & image capturing capabilities.
4. What host- or network-based indicators could be used to identify this malware on infected machines?

With all of the previous information I will infer that this piece of malware hooks itself to OLE processes/libraries, records activity, communicates with an outside host which we'll refer to as 'http://www.malwareanalysisbook.com/ad.html', which given the .html It would seem this file is staging another potential attack after making a connection with the content on said page. From a services/network point of view 'ole32.vd' stuck out to me as this is an unknown file extension which could be manipulated by the malware itself. Service wise I'd check Event Logs. Network wise, any outbound traffic on 80 without an active browser open should indicate the outside vectors IP address.
type 'clear' to clear the screen
