Lab 3-3

My full Analysis

Strings:
'GetLastActivePopup, GetActiveWindow,MessageBoxA, user32.dll, ReadFile, VirtualAlloc, CreateFileSize, CreateFileA, GetCommandLineA, Sleep, Kernel32.dll, WriteFile'
a multitude of different calls, most important ones addressed above. Last entry of interest is \svchost.exe

PeID:

Microsoft Visual C++ 6.0 compiler.

Dependency Walker:

Really nothing of interest, same details are provided in strings output.

Regshot:
HKLM\System\ControlSet01\Services\kmixer\Enum\0
HKLM\System\CurrentControlSet\Services\kmixer\Enum\0

An interesting quick catch was a ROT-13 based subset of strings that when decoded reveal
C:\Documents and Settings\Administrator\Depsktop\Lab03-03.exe pulled from
HKU\S-1-5-21...\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\(serialized numberset\Count\HRZR_EHACNGU\

Regedit:
Imagepath for HKLM\System\CurrentControlSet\Services\kmixer\Enum\0 is system32\drivers\kmixer.sys

Procmon:

Sifting through the debris of a filtered search for Lab03-03.exe we find a new svchost.exe process created on PiD 1824.

Process Explorer:

Checking properties of the infected svchost.exe in 'Strings' we come across a wide array of functions that indicate keystroke logging,
process logging, active/closed application names being recorded and sent to a file where the .exe was ran (in my case, desktop.)
Also note the string labeled practicalmalwareanalysis.log

Back to Procmon:

This time, we're going to just follow svchost.exe to see what's going on. We run the PiD in, open a notepad and write random letters.
The process is captured by procmon and in the system/key logger saved where the original exe was opened from, we see our keystrokes and what window name
they were in.

WireShark / ApdateDNS

Neither provide any context of an outside call. No network activity.
Summary indicates it's a simple keystroke/event logger. Puts window activity along with keystrokes into a .log file located where the .EXe is executed from.
This sounds like a keylogger intended to remain inside of an internal network.

1. What do you notice when monitoring this malware with Process Explorer?

Checking properties of the infected svchost.exe in 'Strings' we come across a wide array of functions that indicate keystroke logging,
process logging, active/closed application names being recorded and sent to a file where the .exe was ran (in my case, desktop.)
Also note the string labeled practicalmalwareanalysis.log

2. Can you identify any live memory modifications?

svchost.exe is spawned by the malware pulling live keystrokes and active clientname that keystrokes were typed in.

3. What are the malware's host-based indicators?

Wherever the .exe of the virus is located a .log file will appear that shows your recorded keystrokes/active tabs of client (i.e. notepad open type test it appears in
document.)

4. What is the purpose of this program?

Record keystrokes on an internal network through a spawned process called svchost and log those files wherever the .exe is executed.
